import std/unittest, necsuspd/pulse, stubs/graphics

suite "Pulse generation":
  test "Creating a pulse":
    let pulse = newPulseConfig(
        size = 16, steps = 5, thickness = 3, fgColor = kColorBlack, seed = 4096
      )
      .buildPulseFrames()
    check pulse.len == 5

    #!fmt: off
    check pulse[0] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________X_______",
      "_______X_X______",
      "________X_______",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",

    ]
    #!fmt: on

    #!fmt: off
    check pulse[1] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "_______XXX______",
      "______X___X_____",
      "_____X____XX____",
      "_____X____XX____",
      "_____X____XX____",
      "______X__XX_____",
      "_______XXX______",
      "________________",
      "________________",
      "________________",
      "________________",
    ]
    #!fmt: on

    #!fmt: off
    check pulse[2] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "_______XXX______",
      "______X_________",
      "_____X_____X____",
      "____X______XX___",
      "____X______XX___",
      "____X______XX___",
      "_____X_____X____",
      "______X_XXX_____",
      "_______XXX______",
      "________________",
      "________________",
      "________________"
    ]
    #!fmt: on

    #!fmt: off
    check pulse[3] == [
      "________________",
      "________________",
      "______XXX_______",
      "_____XX_________",
      "____XX__________",
      "___XX___________",
      "__X___________X_",
      "__X___________X_",
      "__X_____________",
      "__X_____________",
      "__X_____________",
      "___X____________",
      "________________",
      "_________XXX____",
      "_________XX_____",
      "________________",
    ]
    #!fmt: on

    #!fmt: off
    check pulse[4] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "X_______________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
    ]
    #!fmt: on
