import std/unittest, necsuspd/pulse, stubs/graphics

suite "Pulse generation":
  test "Creating a pulse":
    let pulse = newPulseConfig(
        size = 16, steps = 5, thickness = 3, fgColor = kColorBlack, seed = 4096
      )
      .buildPulseFrames()
    check pulse.len == 5

    #!fmt: off
    check pulse[0] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________X_______",
      "_______X_X______",
      "________X_______",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",

    ]
    #!fmt: on

    #!fmt: off
    check pulse[1] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "_______XXX______",
      "______X___X_____",
      "_____XX___XX____",
      "_____X____XX____",
      "_____XX___XX____",
      "______XX_XX_____",
      "_______XXX______",
      "________________",
      "________________",
      "________________",
      "________________"
    ]
    #!fmt: on

    #!fmt: off
    check pulse[2] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "_______XXX______",
      "______X_________",
      "_____X_____X____",
      "____XX_____XX___",
      "____X______XX___",
      "____X______XX___",
      "_____X_____X____",
      "______X__XX_____",
      "_______XXX______",
      "________________",
      "________________",
      "________________",
    ]
    #!fmt: on

    #!fmt: off
    check pulse[3] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "____X___________",
      "___XX________X__",
      "__XX_________XX_",
      "__X___________X_",
      "__X_____________",
      "__X_____________",
      "__X_____________",
      "________________",
      "________________",
      "________________",
      "_________XX_____",
      "________________",
    ]
    #!fmt: on

    #!fmt: off
    check pulse[4] == [
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "________________",
      "_X______________",
      "__X_____________",
      "________________",
      "________________",
    ]
    #!fmt: on
